{% extends "layout.html" %}

{% block head_content %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/tmdb.css') }}">
{% endblock %}

{% block main_content %}
<div class="tmdb-page">
    <!-- Back Navigation -->
    <div class="tmdb-back-nav">
        <a href="{{ url_for('pages.search') }}" class="tmdb-back-link">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
            </svg>
            Back to Search
        </a>
    </div>

    <!-- Movie Hero Section -->
    <div class="tmdb-movie-hero">
        {% if movie.backdrop_url %}
            <div class="tmdb-movie-backdrop">
                <img src="{{ movie.backdrop_url }}" alt="{{ movie.title }}" class="tmdb-movie-backdrop-img">
                <div class="tmdb-movie-backdrop-overlay"></div>
            </div>
        {% endif %}
        
        <div class="tmdb-movie-hero-content">
            <div class="tmdb-movie-poster-large">
                {% if movie.poster_url %}
                    <img src="{{ movie.poster_url }}" alt="{{ movie.title }}" class="tmdb-movie-poster-large-img">
                {% else %}
                    <div class="tmdb-movie-poster-large-placeholder">
                        <svg xmlns="http://www.w3.org/2000/svg" class="tmdb-movie-poster-large-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z" />
                        </svg>
                    </div>
                {% endif %}
            </div>
            
            <div class="tmdb-movie-info">
                <h1 class="tmdb-movie-title">{{ movie.title }}</h1>
                
                {% if movie.tagline %}
                    <p class="tmdb-movie-tagline">{{ movie.tagline }}</p>
                {% endif %}
                
                <div class="tmdb-movie-meta">
                    {% if movie.release_date %}
                        <span class="tmdb-movie-year">{{ movie.release_date.split('-')[0] }}</span>
                    {% endif %}
                    
                    {% if movie.runtime %}
                        <span class="tmdb-movie-runtime">{{ movie.runtime }} min</span>
                    {% endif %}
                    
                    {% if movie.vote_average %}
                        <div class="tmdb-movie-rating-large">
                            <svg xmlns="http://www.w3.org/2000/svg" class="tmdb-rating-star-large" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.784.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                            </svg>
                            <span>{{ "%.1f"|format(movie.vote_average) }}/10</span>
                            <span>({{ movie.vote_count }} votes)</span>
                        </div>
                    {% endif %}
                </div>
                
                {% if movie.genres %}
                    <div class="tmdb-movie-genres">
                        {% for genre in movie.genres %}
                            <span class="tmdb-movie-genre">{{ genre }}</span>
                        {% endfor %}
                    </div>
                {% endif %}
                
                <form method="POST" action="{{ url_for('pages.add_from_tmdb', movie_id=movie.id) }}" class="tmdb-add-form">
                    <button type="submit" class="tmdb-add-button">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                        </svg>
                        Add to Watchlist
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Movie Details -->
    <div class="tmdb-movie-details">
        {% if movie.overview %}
            <div class="tmdb-movie-section">
                <h2 class="tmdb-movie-section-title">Overview</h2>
                <p class="tmdb-movie-overview">{{ movie.overview }}</p>
            </div>
        {% endif %}
        
        {% if director %}
            <div class="tmdb-movie-section">
                <h2 class="tmdb-movie-section-title">Director</h2>
                <p class="tmdb-movie-director">{{ director }}</p>
            </div>
        {% endif %}
        
        {% if cast %}
            <div class="tmdb-movie-section">
                <h2 class="tmdb-movie-section-title">Cast</h2>
                <div class="tmdb-cast-grid">
                    {% for person in cast %}
                        <div class="tmdb-cast-member">
                            <div class="tmdb-cast-photo">
                                {% if person.profile_url %}
                                    <img src="{{ person.profile_url }}" alt="{{ person.name }}" class="tmdb-cast-photo-img">
                                {% else %}
                                    <div class="tmdb-cast-photo-placeholder">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="tmdb-cast-photo-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                        </svg>
                                    </div>
                                {% endif %}
                            </div>
                            <div class="tmdb-cast-info">
                                <h3 class="tmdb-cast-name">{{ person.name }}</h3>
                                <p class="tmdb-cast-character">{{ person.character }}</p>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endif %}
        
        {% if trailer %}
            <div class="tmdb-movie-section">
                <h2 class="tmdb-movie-section-title">Trailer</h2>
                <div class="tmdb-trailer-container">
                    {% if trailer.youtube_url %}
                        <iframe 
                            class="tmdb-trailer-player"
                            src="{{ trailer.youtube_url }}"
                            title="{{ trailer.name }}"
                            frameborder="0"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                            allowfullscreen>
                        </iframe>
                    {% else %}
                        <p>No trailer available</p>
                    {% endif %}
                </div>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}